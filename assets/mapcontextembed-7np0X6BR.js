import{O as t,C as a,c as E}from"./bsConstants-DaZpizR-.js";/* empty css              */t.onReady(async()=>{const m=await t.player.getSelection();if(!m)return await t.popover.close(a.CONTEXTID);const d=document.getElementById("mapStyleSelect"),r=(await t.scene.items.getItems(s=>m[0]===s.id))[0];for(const s of a.ENHANCEDFOGSTYLES){const n=document.createElement("option");n.value=s.key,n.textContent=s.value,d.appendChild(n)}const I=r.metadata[`${a.EXTENSIONID}/hasFogBackground`];I?d.value=I:d.value="NONE",d.onchange=async s=>{const e=(await t.scene.items.getItems(o=>m[0]===o.id))[0],g=s.target;if(g.value==="NONE"){const o=e.metadata[`${a.EXTENSIONID}/FogBackgroundId`];await t.scene.items.deleteItems([o]),await t.scene.items.updateItems([e.id],i=>{for(const c of i)delete c.metadata[`${a.EXTENSIONID}/hasFogBackground`],delete c.metadata[`${a.EXTENSIONID}/FogBackgroundId`]})}else{const o=e.metadata[`${a.EXTENSIONID}/FogBackgroundId`];o&&await t.scene.items.deleteItems([o]);const i=E({height:e.image.height,width:e.image.width,url:e.image.url,mime:e.image.mime},{dpi:e.grid.dpi,offset:e.grid.offset}).rotation(e.rotation).scale(e.scale).position(e.position).attachedTo(e.id).layer("FOG").metadata({[`${a.EXTENSIONID}/isFogBackground`]:e.id}).disableHit(!0).zIndex(-1).build();await t.broadcast.sendMessage(`${a.EXTENSIONID}/FOGBACKGROUNDEVENT`,{MapId:i.id,FogStyle:g.value},{destination:"ALL"}),await t.scene.items.addItems([i]),await t.scene.items.updateItems([e.id],c=>{for(const l of c)l.metadata[`${a.EXTENSIONID}/hasFogBackground`]=g.value,l.metadata[`${a.EXTENSIONID}/FogBackgroundId`]=i.id})}}});
