import{O as o,C as i,L as D}from"./bsConstants-BBf8oFU1.js";/* empty css              */o.onReady(async()=>{const m=await o.player.getSelection();if(!m)return await o.popover.close(i.CONTEXTID);const v=document.getElementById("visionContext"),d=document.getElementById("bumperContext"),f=document.getElementById("falloffContext"),g=document.getElementById("darkContext"),N=document.getElementById("innerContext"),E=document.getElementById("outerContext"),c=document.getElementById("visionOwnerSelect"),p=document.getElementById("unitDepthSelect"),I=document.getElementById("visionLightDirectionSelect");for(const e of Object.values(D)){const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0)+e.slice(1).toLowerCase(),I.appendChild(t)}const l=await o.scene.items.getItems(e=>m?.includes(e.id)),O=await o.party.getPlayers(),r=document.createElement("option");r.value=await o.player.getId(),r.textContent=await o.player.getName(),r.style.color=await o.player.getColor(),c.appendChild(r);for(const e of O){const t=document.createElement("option");t.value=e.id,t.textContent=e.name,t.style.color=e.color,c.appendChild(t)}const S=await o.scene.getMetadata();if(c.value="",l.length===1){const e=l[0];c.value=e.createdUserId,v.value=e.metadata[`${i.EXTENSIONID}/visionRange`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionRange`]:s("visionRangeDefault"),d.value=e.metadata[`${i.EXTENSIONID}/visionSourceRange`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionSourceRange`]:s("visionSourceDefault"),f.value=e.metadata[`${i.EXTENSIONID}/visionFallOff`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionFallOff`]:s("visionFallOffDefault"),N.value=e.metadata[`${i.EXTENSIONID}/visionInAngle`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionInAngle`]:s("visionInAngleDefault"),E.value=e.metadata[`${i.EXTENSIONID}/visionOutAngle`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionOutAngle`]:s("visionOutAngleDefault"),g.value=e.metadata[`${i.EXTENSIONID}/visionDark`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionDark`]:s("visionDarkDefault"),p.value=e.metadata[`${i.EXTENSIONID}/unitDepth`]!==void 0?e.metadata[`${i.EXTENSIONID}/unitDepth`]:"0",I.value=e.metadata[`${i.EXTENSIONID}/visionFacing`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionFacing`]:Object.values(D)[0]}I.onchange=async e=>{const t=e.currentTarget;await o.scene.items.updateItems(l.map(a=>a.id),a=>{for(const n of a)n.metadata[`${i.EXTENSIONID}/visionFacing`]=t.value})},c.onchange=async e=>{const t=e.currentTarget;await o.scene.items.updateItems(l.map(a=>a.id),a=>{for(const n of a)n.createdUserId=t.value})},v.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseInt(t.value);a<0&&(t.value="0"),a>999&&(t.value="999"),isNaN(a)&&(t.value=s("visionRangeDefault")),await o.scene.items.updateItems(l.map(n=>n.id),n=>{for(let u of n)u.metadata[`${i.EXTENSIONID}/visionRange`]=t.value})},d.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseFloat(t.value);a<0&&(t.value="0"),a>999&&(t.value="999"),isNaN(a)&&(t.value=s("visionSourceDefault")),await o.scene.items.updateItems(l.map(n=>n.id),n=>{for(let u of n)u.metadata[`${i.EXTENSIONID}/visionSourceRange`]=t.value})},f.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseFloat(t.value);a<0&&(t.value="0"),a>10&&(t.value="10"),isNaN(a)&&(t.value=s("visionFallOffDefault")),await o.scene.items.updateItems(l.map(n=>n.id),n=>{for(let u of n)u.metadata[`${i.EXTENSIONID}/visionFallOff`]=t.value})},N.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseInt(t.value);a<-360&&(t.value="-360"),a>360&&(t.value="360"),isNaN(a)&&(t.value=s("visionInAngleDefault")),await o.scene.items.updateItems(l.map(n=>n.id),n=>{for(let u of n)u.metadata[`${i.EXTENSIONID}/visionInAngle`]=t.value})},E.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseInt(t.value);a<-360&&(t.value="-360"),a>360&&(t.value="360"),isNaN(a)&&(t.value=s("visionOutAngleDefault")),await o.scene.items.updateItems(l.map(n=>n.id),n=>{for(let u of n)u.metadata[`${i.EXTENSIONID}/visionOutAngle`]=t.value})},g.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseInt(t.value);a<0&&(t.value="0"),a>999&&(t.value="999"),isNaN(a)&&(t.value=s("visionDarkDefault")),await o.scene.items.updateItems(l.map(n=>n.id),n=>{for(let u of n)u.metadata[`${i.EXTENSIONID}/visionDark`]=t.value})},p.onchange=async e=>{const t=e.currentTarget;await o.scene.items.updateItems(l.map(a=>a.id),a=>{for(const n of a)t.value==="0"?delete n.metadata[`${i.EXTENSIONID}/unitDepth`]:n.metadata[`${i.EXTENSIONID}/unitDepth`]=t.value})};function s(e){const t=S[`${i.EXTENSIONID}/${e}`];return t||i.ATTENUATIONDEFAULT}});
