import{O as o,C as i}from"./bsConstants-Va2x9yT4.js";/* empty css              */o.onReady(async()=>{const I=await o.player.getSelection();if(!I)return await o.popover.close(i.CONTEXTID);const m=document.getElementById("visionContext"),v=document.getElementById("bumperContext"),d=document.getElementById("falloffContext"),f=document.getElementById("darkContext"),g=document.getElementById("innerContext"),N=document.getElementById("outerContext"),r=document.getElementById("visionOwnerSelect"),E=document.getElementById("unitDepthSelect"),u=await o.scene.items.getItems(e=>I?.includes(e.id)),p=await o.party.getPlayers(),c=document.createElement("option");c.value=await o.player.getId(),c.textContent=await o.player.getName(),c.style.color=await o.player.getColor(),r.appendChild(c);for(const e of p){const t=document.createElement("option");t.value=e.id,t.textContent=e.name,t.style.color=e.color,r.appendChild(t)}const D=await o.scene.getMetadata();if(r.value="",u.length===1){const e=u[0];r.value=e.createdUserId,m.value=e.metadata[`${i.EXTENSIONID}/visionRange`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionRange`]:s("visionRangeDefault"),v.value=e.metadata[`${i.EXTENSIONID}/visionSourceRange`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionSourceRange`]:s("visionSourceDefault"),d.value=e.metadata[`${i.EXTENSIONID}/visionFallOff`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionFallOff`]:s("visionFallOffDefault"),g.value=e.metadata[`${i.EXTENSIONID}/visionInAngle`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionInAngle`]:s("visionInAngleDefault"),N.value=e.metadata[`${i.EXTENSIONID}/visionOutAngle`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionOutAngle`]:s("visionOutAngleDefault"),f.value=e.metadata[`${i.EXTENSIONID}/visionDark`]!==void 0?e.metadata[`${i.EXTENSIONID}/visionDark`]:s("visionDarkDefault"),E.value=e.metadata[`${i.EXTENSIONID}/unitDepth`]!==void 0?e.metadata[`${i.EXTENSIONID}/unitDepth`]:"0"}r.onchange=async e=>{const t=e.currentTarget;await o.scene.items.updateItems(u.map(a=>a.id),a=>{for(const n of a)n.createdUserId=t.value})},m.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseInt(t.value);a<0&&(t.value="0"),a>999&&(t.value="999"),isNaN(a)&&(t.value=s("visionRangeDefault")),await o.scene.items.updateItems(u.map(n=>n.id),n=>{for(let l of n)l.metadata[`${i.EXTENSIONID}/visionRange`]=t.value})},v.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseFloat(t.value);a<0&&(t.value="0"),a>999&&(t.value="999"),isNaN(a)&&(t.value=s("visionSourceDefault")),await o.scene.items.updateItems(u.map(n=>n.id),n=>{for(let l of n)l.metadata[`${i.EXTENSIONID}/visionSourceRange`]=t.value})},d.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseFloat(t.value);a<0&&(t.value="0"),a>10&&(t.value="10"),isNaN(a)&&(t.value=s("visionFallOffDefault")),await o.scene.items.updateItems(u.map(n=>n.id),n=>{for(let l of n)l.metadata[`${i.EXTENSIONID}/visionFallOff`]=t.value})},g.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseInt(t.value);a<0&&(t.value="0"),a>360&&(t.value="360"),isNaN(a)&&(t.value=s("visionInAngleDefault")),await o.scene.items.updateItems(u.map(n=>n.id),n=>{for(let l of n)l.metadata[`${i.EXTENSIONID}/visionInAngle`]=t.value})},N.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseInt(t.value);a<0&&(t.value="0"),a>360&&(t.value="360"),isNaN(a)&&(t.value=s("visionOutAngleDefault")),await o.scene.items.updateItems(u.map(n=>n.id),n=>{for(let l of n)l.metadata[`${i.EXTENSIONID}/visionOutAngle`]=t.value})},f.onchange=async e=>{if(!e||!e.target)return;const t=e.target,a=parseInt(t.value);a<0&&(t.value="0"),a>999&&(t.value="999"),isNaN(a)&&(t.value=s("visionDarkDefault")),await o.scene.items.updateItems(u.map(n=>n.id),n=>{for(let l of n)l.metadata[`${i.EXTENSIONID}/visionDark`]=t.value})},E.onchange=async e=>{const t=e.currentTarget;await o.scene.items.updateItems(u.map(a=>a.id),a=>{for(const n of a)t.value==="0"?delete n.metadata[`${i.EXTENSIONID}/unitDepth`]:n.metadata[`${i.EXTENSIONID}/unitDepth`]=t.value})};function s(e){const t=D[`${i.EXTENSIONID}/${e}`];return t||i.ATTENUATIONDEFAULT}});
